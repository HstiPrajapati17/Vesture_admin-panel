<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>User Orders</title>

	<!-- Bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="/css/Sidebar.css">
	<link rel="stylesheet" href="/css/sales.css">
</head>

<body>
	<!-- Sidebar -->
	<div id="sidebar-container"></div>

	<!-- Navbar -->
	<div id="navbar-container"></div>

	<main class="main-content custome-height-main-content" id="main-content">
		<div class="container-fluid">

			<!-- User Orders Table -->
			<div class="h_order-list mt-4">
				<div class="d-flex justify-content-between align-items-center mb-3">
					<h4>My Orders</h4>
					<div class="dropdown">
						<button class="btn h_order-list-filter-btn dropdown-toggle" type="button" id="filterDropdown"
							data-bs-toggle="dropdown" aria-expanded="false">
							Recent
						</button>
						<ul class="dropdown-menu" aria-labelledby="filterDropdown">
							<li><a class="dropdown-item" href="#">Last 7 Days</a></li>
							<li><a class="dropdown-item" href="#">Last 30 Days</a></li>
							<li><a class="dropdown-item" href="#">This Year</a></li>
							<li><a class="dropdown-item" href="#">All Orders</a></li>
						</ul>
					</div>
				</div>

				<div class="table-responsive">
					<table class="table h_custom-sales-table align-middle text-center" id="orderTable">
						<thead class="table-dark">
							<tr>
								<th>#</th>
								<th>Order ID</th>
								<th>Items</th>
								<th>Status</th>
								<th>Total (INR)</th>
								<th>Date</th>
								<th>Action</th>
							</tr>
						</thead>
						<tbody id="tableBody">
						</tbody>
					</table>
				</div>

				<!-- Pagination -->
				<nav class="d-flex justify-content-center align-items-center mt-3 gap-3">
					<button class="btn btn-sm h_order-list-filter-btn" id="prevBtn">Prev</button>
					<span id="pageInfo" class="fw-bold" style="color: #604652;">1/1</span>
					<button class="btn btn-sm h_order-list-filter-btn" id="nextBtn">Next</button>
				</nav>
			</div>
		</div>
	</main>

	<!-- Order Details Modal -->
	<div class="modal fade" id="orderModal" tabindex="-1" aria-labelledby="orderModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="orderModalLabel">Order Details</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body" id="modalContent">
					<!-- Dynamic order details -->
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Overlay for mobile -->
	<div class="overlay"></div>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="/js/sidebar-loader.js"></script>
	<script src="/js/navbar-loader.js"></script>

	<script>
		// User Orders Data
		const orders = [
			{
				no: 1, id: "#160506", status: "Processing",
				total: "₹2,450", date: "2023-11-12",
				products: [
					{ name: "Casual Shirt", size: "M", color: "Blue", qty: 2 },
					{ name: "Denim Jeans", size: "32", color: "Black", qty: 1 }
				]
			},
			{
				no: 2, id: "#161002", status: "Shipped",
				total: "₹1,800", date: "2023-11-15",
				products: [
					{ name: "Hoodie", size: "L", color: "Grey", qty: 1 }
				]
			},
			{
				no: 3, id: "#141026", status: "Cancelled",
				total: "₹3,250", date: "2023-11-18",
				products: [
					{ name: "Kurta Set", size: "XL", color: "White", qty: 2 }
				]
			},
			{
				no: 4, id: "#131427", status: "Delivered",
				total: "₹980", date: "2023-11-20",
				products: [
					{ name: "T-shirt", size: "S", color: "Red", qty: 1 }
				]
			},
			{
				no: 5, id: "#124805", status: "Delivered",
				total: "₹4,500", date: "2023-11-22",
				products: [
					{ name: "Winter Jacket", size: "M", color: "Black", qty: 1 }
				]
			},
			{
				no: 6, id: "#126106", status: "Processing",
				total: "₹1,250", date: "2023-11-25",
				products: [
					{ name: "Polo Shirt", size: "L", color: "Navy", qty: 2 }
				]
			},
			{
				no: 7, id: "#122907", status: "Shipped",
				total: "₹3,600", date: "2023-11-27",
				products: [
					{ name: "Formal Pants", size: "34", color: "Grey", qty: 2 }
				]
			},
			{
				no: 8, id: "#111048", status: "Delivered",
				total: "₹2,750", date: "2023-11-29",
				products: [
					{ name: "Sports Shorts", size: "M", color: "Black", qty: 2 }
				]
			},
			{
				no: 9, id: "#111709", status: "Cancelled",
				total: "₹1,150", date: "2023-12-01",
				products: [
					{ name: "Casual Shirt", size: "L", color: "Green", qty: 1 }
				]
			},
			{
				no: 10, id: "#101770", status: "Delivered",
				total: "₹5,200", date: "2023-12-03",
				products: [
					{ name: "Blazer", size: "40", color: "Black", qty: 1 },
					{ name: "Formal Shirt", size: "M", color: "White", qty: 2 }
				]
			}
		];

		const rowsPerPage = 5;
		let currentPage = 1;

		function renderTable() {
			const tableBody = document.getElementById('tableBody');
			tableBody.innerHTML = "";

			const start = (currentPage - 1) * rowsPerPage;
			const totalPages = Math.ceil(orders.length / rowsPerPage);
			const end = start + rowsPerPage;
			const paginatedOrders = orders.slice(start, end);

			paginatedOrders.forEach(order => {
				const statusBadge = `<span class="custom-badge">${order.status}</span>`;

				const tr = document.createElement('tr');
				tr.innerHTML = `
					<td>${order.no}</td>
					<td>${order.id}</td>
					<td>${order.products.length} Item(s)</td>
					<td>${statusBadge}</td>
					<td>${order.total}</td>
					<td>${order.date}</td>
					<td>
						<button class="btn btn-sm me-1 orderlist-table-icons" onclick="viewOrder(${order.no})">
							<i class="bi bi-eye"></i>
						</button>
					</td>
				`;
				tableBody.appendChild(tr);
			});

			document.getElementById("pageInfo").innerText =
				`${currentPage}/${Math.ceil(orders.length / rowsPerPage)}`;
				
    // document.getElementById("pageInfo").innerText = `${currentPage}/${totalPages}`;
    
    // Disable/enable pagination buttons based on current page
    document.getElementById("prevBtn").disabled = currentPage === 1;
    document.getElementById("nextBtn").disabled = currentPage === totalPages;
		}

		// View Order in Modal
		function viewOrder(orderNo) {
			const order = orders.find(o => o.no === orderNo);
			if (order) {
				let productRows = order.products.map(p =>
					`<tr>
						<td>${p.name}</td>
						<td>${p.size}</td>
						<td>${p.color}</td>
						<td>${p.qty}</td>
					</tr>`
				).join("");

				document.getElementById("modalContent").innerHTML = `
					<p><strong>Order ID:</strong> ${order.id}</p>
					<p><strong>Status:</strong> ${order.status}</p>
					<p><strong>Total:</strong> ${order.total}</p>
					<p><strong>Order Date:</strong> ${order.date}</p>

					<h6 class="mt-3">Products</h6>
					<div class="table-responsive">
						<table class="table table-bordered text-center">
							<thead class="table-light">
								<tr>
									<th>Product Name</th>
									<th>Size</th>
									<th>Color</th>
									<th>Qty</th>
								</tr>
							</thead>
							<tbody>
								${productRows}
							</tbody>
						</table>
					</div>
				`;
				new bootstrap.Modal(document.getElementById("orderModal")).show();
			}
		}

		// Pagination
		document.getElementById("prevBtn").addEventListener("click", () => {
			if (currentPage > 1) {
				currentPage--;
				renderTable();
			}
		});
		document.getElementById("nextBtn").addEventListener("click", () => {
			if (currentPage < Math.ceil(orders.length / rowsPerPage)) {
				currentPage++;
				renderTable();
			}
		});

		// Initial Render
		renderTable();
	</script>
</body>

</html>
