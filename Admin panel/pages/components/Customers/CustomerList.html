<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Customer list â€” Clothing Manufacturing</title>

	<!-- Bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

	<!-- External CSS -->
	<link rel="stylesheet" href="/css/Sidebar.css">
	<link rel="stylesheet" href="/css/customer.css">
	<link rel="stylesheet" href="/css/modal-theme.css">
</head>

<body class="userlist_body">
	<!-- Sidebar -->
	<div id="sidebar-container"></div>
	<!-- Navbar -->
	<div id="navbar-container"></div>

	<main class="main-content" id="main-content">
		<div class="container-fluid p-0 h_userlist_container">
			<!-- Customer List -->
			<div class="h_user-list mt-4">
				<div class="d-flex justify-content-between align-items-center mb-3">
					<h4>All Customers</h4>
					<div class="dropdown">
						<button class="btn h_user-list-filter-btn dropdown-toggle" type="button" id="filterDropdown"
							data-bs-toggle="dropdown" aria-expanded="false">This Month</button>
						<ul class="dropdown-menu" aria-labelledby="filterDropdown">
							<li><a class="dropdown-item" href="#">This Week</a></li>
							<li><a class="dropdown-item" href="#">This Month</a></li>
							<li><a class="dropdown-item" href="#">This Year</a></li>
							<li><a class="dropdown-item" href="#">All Time</a></li>
						</ul>
					</div>
				</div>

				<div class="table-responsive">
					<table class="table h_custom-table align-middle" id="customerTable">
						<thead>
							<tr>
								<th><input type="checkbox" id="selectAll"><label for="selectAll"></label></th>
								<th>Customer</th>
								<th>Email</th>
								<th>Phone</th>
								<th>City</th>
								<th>Type</th>
								<th>Actions</th>
							</tr>
						</thead>
						<tbody id="customerTableBody"></tbody>
					</table>
				</div>

				<!-- Pagination -->
				<nav class="d-flex justify-content-center align-items-center mt-3 gap-3">
					<button class="btn btn-sm h_user-list-filter-btn" id="prevCustomerBtn">Prev</button>
					<span id="customerPageInfo" class="fw-bold">1/3</span>
					<button class="btn btn-sm h_user-list-filter-btn" id="nextCustomerBtn">Next</button>
				</nav>
			</div>
		</div>
	</main>

	<!-- Overlay -->
	<div class="overlay"></div>

	<!-- View Customer Modal -->
	<div class="modal fade" id="viewUserModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content custom-modal">
				<div class="modal-header">
					<h5 class="modal-title">View Customer</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body text-center">
					<img id="viewImage" src="" alt="Customer Image" class="rounded-circle mb-3"
						style="width:100px;height:100px;object-fit:cover;border:3px solid #607472;">
					<p><strong>Name:</strong> <span id="viewName"></span></p>
					<p><strong>Email:</strong> <span id="viewEmail"></span></p>
					<p><strong>Phone:</strong> <span id="viewPhone"></span></p>
					<p><strong>City:</strong> <span id="viewCity"></span></p>
					<p><strong>Type:</strong> <span id="viewType"></span></p>
				</div>
			</div>
		</div>
	</div>

	<!-- Delete Customer Modal -->
	<div class="modal fade" id="deleteCustomerModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content custom-modal">
				<div class="modal-header">
					<h5 class="modal-title">Delete Customer</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p id="deleteUserMessage">Are you sure you want to delete this customer?</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" id="confirmDeleteBtn" class="btn btn-danger">Delete</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Edit Customer Modal -->
	<div class="modal fade" id="editCustomerModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content custom-modal">
				<div class="modal-header">
					<h5 class="modal-title">Edit Customer</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="editCustomerForm">
						<input type="hidden" id="editIndex">
						<div class="mb-2">
							<input type="text" id="editName" class="form-control" placeholder="Name" required>
						</div>
						<div class="mb-2">
							<input type="email" id="editEmail" class="form-control" placeholder="Email" required>
						</div>
						<div class="mb-2">
							<input type="text" id="editPhone" class="form-control" placeholder="Phone" required>
						</div>
						<div class="mb-2">
							<input type="text" id="editCity" class="form-control" placeholder="City" required>
						</div>
						<div class="mb-2">
							<select id="editType" class="form-select" required>
								<option value="Retail">Retail</option>
								<option value="Wholesale">Wholesale</option>
								<option value="VIP">VIP</option>
							</select>
						</div>
						<button type="submit" class="btn edit-save-btn">Save</button>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- Bootstrap Bundle -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="/js/sidebar-loader.js"></script>
	<script src="/js/navbar-loader.js"></script>

	<script>
		const customers = [
			{ name: "Alice Johnson", image: "https://randomuser.me/api/portraits/women/44.jpg", email: "alice@example.com", phone: "123-456-7890", city: "Toronto", type: "Retail" },
			{ name: "Bob Smith", image: "https://randomuser.me/api/portraits/men/45.jpg", email: "bob@example.com", phone: "234-567-8901", city: "Vancouver", type: "Wholesale" },
			{ name: "Charlie Lee", image: "https://randomuser.me/api/portraits/men/32.jpg", email: "charlie@example.com", phone: "345-678-9012", city: "Montreal", type: "VIP" },
			{ name: "Diana Cruz", image: "https://randomuser.me/api/portraits/women/68.jpg", email: "diana@example.com", phone: "456-789-0123", city: "Calgary", type: "Retail" },
			{ name: "Ethan Kim", image: "https://randomuser.me/api/portraits/men/41.jpg", email: "ethan@example.com", phone: "567-890-1234", city: "Ottawa", type: "Wholesale" },
			{ name: "Fiona Lopez", image: "https://randomuser.me/api/portraits/women/52.jpg", email: "fiona@example.com", phone: "678-901-2345", city: "Edmonton", type: "VIP" }
		];

		const rowsPerPage = 5;
		let currentPage = 1;
		let deleteIndex;

		// Render table with pagination
		function renderCustomerTable() {
			const tbody = document.getElementById("customerTableBody");
			tbody.innerHTML = "";
			const start = (currentPage - 1) * rowsPerPage;
			const end = start + rowsPerPage;
			const paginatedCustomers = customers.slice(start, end);

			paginatedCustomers.forEach((c, index) => {
				const tr = document.createElement("tr");
				tr.innerHTML = `
					<td><input type="checkbox" id="check${index}"><label for="check${index}"></label></td>
					<td class="user-info"><img src="${c.image}" alt="${c.name}" class="user-img"> ${c.name}</td>
					<td>${c.email}</td>
					<td>${c.phone}</td>
					<td>${c.city}</td>
					<td>${c.type}</td>
					<td>
						<button class="btn btn-sm h_user-list-btn viewBtn"><i class="bi bi-eye"></i></button>
						<button class="btn btn-sm h_user-list-btn editBtn"><i class="bi bi-pencil-square"></i></button>
						<button class="btn btn-sm h_user-list-btn deleteBtn"><i class="bi bi-trash3"></i></button>
					</td>
				`;
				tbody.appendChild(tr);

				// View Customer
				tr.querySelector(".viewBtn").addEventListener("click", () => {
					document.getElementById("viewImage").src = c.image;
					document.getElementById("viewName").innerText = c.name;
					document.getElementById("viewEmail").innerText = c.email;
					document.getElementById("viewPhone").innerText = c.phone;
					document.getElementById("viewCity").innerText = c.city;
					document.getElementById("viewType").innerText = c.type;
					new bootstrap.Modal(document.getElementById("viewUserModal")).show();
				});

				// Edit Customer
				tr.querySelector(".editBtn").addEventListener("click", () => {
					document.getElementById("editIndex").value = start + index;
					document.getElementById("editName").value = c.name;
					document.getElementById("editEmail").value = c.email;
					document.getElementById("editPhone").value = c.phone;
					document.getElementById("editCity").value = c.city;
					document.getElementById("editType").value = c.type;
					new bootstrap.Modal(document.getElementById("editCustomerModal")).show();
				});

				// Delete Customer
				tr.querySelector(".deleteBtn").addEventListener("click", () => {
					deleteIndex = start + index;
					document.getElementById("deleteUserMessage").innerText =
						`Are you sure you want to delete ${c.name}?`;
					new bootstrap.Modal(document.getElementById("deleteCustomerModal")).show();
				});
			});

			// Update page info
			document.getElementById("customerPageInfo").innerText =
				`${currentPage}/${Math.ceil(customers.length / rowsPerPage)}`;

			// Attach checkbox listeners
			attachCheckboxListeners();
			updateSelectAllCheckbox();
		}

		// Edit form submit
		document.getElementById("editCustomerForm").addEventListener("submit", (e) => {
			e.preventDefault();
			const idx = document.getElementById("editIndex").value;
			customers[idx] = {
				...customers[idx],
				name: document.getElementById("editName").value,
				email: document.getElementById("editEmail").value,
				phone: document.getElementById("editPhone").value,
				city: document.getElementById("editCity").value,
				type: document.getElementById("editType").value
			};
			renderCustomerTable();
			bootstrap.Modal.getInstance(document.getElementById("editCustomerModal")).hide();
		});

		// Delete confirmation
		document.getElementById("confirmDeleteBtn").addEventListener("click", () => {
			if (deleteIndex !== undefined) {
				customers.splice(deleteIndex, 1);
				renderCustomerTable();
				bootstrap.Modal.getInstance(document.getElementById("deleteCustomerModal")).hide();
			}
		});

		// Pagination buttons
		document.getElementById("prevCustomerBtn").addEventListener("click", () => {
			if (currentPage > 1) {
				currentPage--;
				renderCustomerTable();
			}
		});
		document.getElementById("nextCustomerBtn").addEventListener("click", () => {
			if (currentPage < Math.ceil(customers.length / rowsPerPage)) {
				currentPage++;
				renderCustomerTable();
			}
		});

		// Checkbox logic
		function attachCheckboxListeners() {
			const allCheckboxes = document.querySelectorAll('#customerTableBody input[type="checkbox"]');
			allCheckboxes.forEach(cb => {
				cb.addEventListener('change', updateSelectAllCheckbox);
			});
		}

		function updateSelectAllCheckbox() {
			const allCheckboxes = document.querySelectorAll('#customerTableBody input[type="checkbox"]');
			const selectAll = document.getElementById('selectAll');
			selectAll.checked = allCheckboxes.length > 0 && Array.from(allCheckboxes).every(cb => cb.checked);
		}

		document.getElementById('selectAll').addEventListener('change', function () {
			const allCheckboxes = document.querySelectorAll('#customerTableBody input[type="checkbox"]');
			allCheckboxes.forEach(cb => cb.checked = this.checked);
		});

		// Initial render
		renderCustomerTable();
	</script>

</body>

</html>