<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Hera Fashion - Shop All Products</title>

	<!-- Bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="/css/Sidebar.css">
	<link rel="stylesheet" href="/css/product.css">

</head>

<body>
	<!-- Sidebar -->
	<div id="sidebar-container"></div>

	<!-- Navbar -->
	<div id="navbar-container"></div>

	<main class="main-content" id="main-content">
		<div class="shop-layout">

			<!-- Sidebar -->
			<aside class="shop-sidebar">
				<div class="sidebar-section">
					<h6 class="sidebar-title">Search Products</h6>
					<input id="search" class="form-control" placeholder="Search products...">
				</div>

				<div class="sidebar-section">
					<h6 class="sidebar-title">Filter by Category</h6>
					<select id="filter" class="form-select">
						<option value="all">All Categories</option>
						<option value="Men">Men</option>
						<option value="Women">Women</option>
						<option value="Kids">Kids</option>
						<option value="Unisex">Unisex</option>
					</select>
				</div>

				<div class="sidebar-section">
					<h6 class="sidebar-title">Price Range</h6>
					<div class="price-range">
						<input type="number" id="minPrice" placeholder="Min">
						<span>–</span>
						<input type="number" id="maxPrice" placeholder="Max">
					</div>
				</div>

				<div class="sidebar-section">
					<h6 class="sidebar-title">Sort By</h6>
					<select id="sort" class="form-select">
						<option value="default">Default</option>
						<option value="price-asc">Price: Low to High</option>
						<option value="price-desc">Price: High to Low</option>
						<option value="newest">Newest</option>
					</select>
				</div>

				<button id="reset" class="btn btn-reset">
					<i class="bi bi-arrow-clockwise me-2"></i> Reset Filters
				</button>
			</aside>

			<!-- Main Content -->
			<section class="shop-main">
				<div class="page-header">
					<h1 class="page-title">All Products</h1>
					<div class="d-flex gap-2">
						<!-- Grid / List Toggle -->
						<button id="gridView" class="btn btn-sm btn-outline-dark active">
							<i class="bi bi-grid-fill"></i>
						</button>
						<button id="listView" class="btn btn-sm btn-outline-dark">
							<i class="bi bi-list-ul"></i>
						</button>
					</div>
				</div>

				<div id="products" class="products-grid"></div>

				<div id="empty" class="empty-state d-none">
					<i class="bi bi-box-seam"></i>
					<h4>No products found!</h4>
					<p>Try adjusting your filters or search query.</p>
					<button id="empty-refresh" class="btn btn-primary mt-3">
						<i class="bi bi-arrow-clockwise me-2"></i>Browse All
					</button>
				</div>

				<div class="pagination-wrapper">
					<button id="prev" class="page-btn">Previous</button>
					<div id="page-indicator" class="text-dark fw-bold">1 / 1</div>
					<button id="next" class="page-btn">Next</button>
				</div>
			</section>
		</div>
	</main>

	<!-- Edit Product Modal -->
	<div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Edit Product</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="editForm">
						<input type="hidden" id="editSku">
						<div class="mb-3">
							<label class="form-label">Product Name</label>
							<input type="text" id="editName" class="form-control" required>
						</div>
						<div class="mb-3">
							<label class="form-label">Category</label>
							<input type="text" id="editCategory" class="form-control" required>
						</div>
						<div class="mb-3">
							<label class="form-label">Price ($)</label>
							<input type="number" id="editPrice" class="form-control" step="0.01" required>
						</div>
						<div class="mb-3">
							<label class="form-label">Stock</label>
							<input type="number" id="editStock" class="form-control" required>
						</div>
						<button type="submit" class="btn btn-secondary w-100">Save Changes</button>
					</form>
				</div>
			</div>
		</div>

	</div>

	<!-- Delete Confirmation Modal -->
	<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header text-black">
					<h5 class="modal-title">Confirm Delete</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p id="deleteMessage">Are you sure you want to delete this product?</p>
					<input type="hidden" id="deleteSku">
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" id="confirmDelete" class="btn btn-danger">Delete</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Overlay for mobile -->
	<div class="overlay"></div>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="/js/sidebar-loader.js"></script>
	<script src="/js/navbar-loader.js"></script>

	<script>
		const products = [
			{ sku: 'TS-001', name: 'Vintage Comfort T-shirt', category: 'Men', price: 29.99, stock: 120, img: 'https://images.meesho.com/images/products/402850146/n7jle_512.avif?width=512', rating: 4.5, reviews: 85, added: '2023-01-15' },
			{ sku: 'BG-777', name: 'Leather Jacket', category: 'Unisex', price: 65.00, stock: 50, img: 'https://www.globalrepublic.in/cdn/shop/files/1_17eb7cf2-73f3-4343-95bd-0f0633900ead.jpg?v=1705393220&width=700', rating: 4.4, reviews: 58, added: '2023-05-05' },
			{ sku: 'KD-101', name: 'Kids Cartoon T-shirt', category: 'Kids', price: 19.99, stock: 40, img: 'https://m.media-amazon.com/images/I/61eTU-T8VUL._SX679_.jpg', rating: 4.6, reviews: 32, added: '2023-03-18' },
			{ sku: 'WM-322', name: 'Women Summer Dress', category: 'Women', price: 55.00, stock: 25, img: 'https://i.pinimg.com/736x/25/05/e6/2505e613a83614c85b3dab69575a72b3.jpg', rating: 4.7, reviews: 76, added: '2023-04-02' },
			{ sku: 'MS-110', name: 'Classic White Shirt', category: 'Men', price: 40.00, stock: 32, img: 'https://www.beyours.in/cdn/shop/files/white-2.jpg?v=1729102400', rating: 4.8, reviews: 98, added: '2023-06-12' },
			{ sku: 'KD-202', name: 'Princess Party Dress', category: 'Kids', price: 35.00, stock: 12, img: 'https://www.cutedoll.in/cdn/shop/files/3158A.jpg?v=1715855457&width=713', rating: 4.3, reviews: 41, added: '2023-05-15' },
			{ sku: 'WM-450', name: 'Wool Cardigan', category: 'Women', price: 62.00, stock: 14, img: 'https://pachamamaknitwear.com/products/elvcm/c2feef3048b55ae5c9a2bbcdf856a1cd.webp', rating: 4.6, reviews: 54, added: '2023-06-05' },
			{ sku: 'WT-205', name: 'Kids Summer Outfit Set', category: 'Kids', price: 48.00, stock: 20, img: 'https://img.kwcdn.com/product/fancy/b0e91703-eb88-4183-8622-9d903a089819.jpg?imageView2/2/w/500/q/60/format/webp', rating: 4.5, reviews: 67, added: '2023-07-01' },
			{ sku: 'DJ-212', name: 'Classic Blue Denim Jacket', category: 'Women', price: 89.50, stock: 6, img: 'https://m.media-amazon.com/images/I/81gUcmM3npL._UY350_.jpg', rating: 4.8, reviews: 112, added: '2023-02-20' },
			{ sku: 'HD-045', name: 'Urban Style Hoodie', category: 'Unisex', price: 45.00, stock: 58, img: 'https://m.media-amazon.com/images/I/616GHHflDkL._SX569_.jpg', rating: 4.2, reviews: 60, added: '2023-03-10' },
			{ sku: 'SN-550', name: 'Slim Fit Black Jeans', category: 'Men', price: 75.00, stock: 18, img: 'https://cottonking.com/cdn/shop/files/D42930-1_640x_crop_center.jpg?v=1706685813', rating: 4.9, reviews: 142, added: '2023-04-22' },
		];


		let pageSize = 9, currentPage = 1, currentFilter = 'all', currentQuery = '', currentSort = 'default';
		let currentMinPrice = '', currentMaxPrice = '', currentStock = 'all';
		const wishlist = new Set();
		const cart = new Set();

		const productsEl = document.getElementById('products');
		const emptyEl = document.getElementById('empty');
		const pageIndicator = document.getElementById('page-indicator');

		function renderProducts() {
			let filtered = products.filter(p => {
				const matchCategory = currentFilter === 'all' || p.category.toLowerCase() === currentFilter.toLowerCase();
				const q = currentQuery.trim().toLowerCase();
				const matchQuery = !q || p.name.toLowerCase().includes(q);

				const matchPrice = (!currentMinPrice || p.price >= currentMinPrice) &&
					(!currentMaxPrice || p.price <= currentMaxPrice);

				let matchStock = true;
				if (currentStock === 'in') matchStock = p.stock > 10;
				if (currentStock === 'low') matchStock = p.stock > 0 && p.stock <= 10;
				if (currentStock === 'out') matchStock = p.stock <= 0;

				return matchCategory && matchQuery && matchPrice && matchStock;
			});

			if (currentSort === 'price-asc') filtered.sort((a, b) => a.price - b.price);
			if (currentSort === 'price-desc') filtered.sort((a, b) => b.price - a.price);
			if (currentSort === 'newest') filtered.sort((a, b) => new Date(b.added) - new Date(a.added));

			const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));
			if (currentPage > totalPages) currentPage = totalPages;

			const start = (currentPage - 1) * pageSize;
			const pageItems = filtered.slice(start, start + pageSize);

			productsEl.innerHTML = '';
			if (pageItems.length === 0) {
				emptyEl.classList.remove('d-none');
			} else {
				emptyEl.classList.add('d-none');

				if (currentView === 'grid') {
					// GRID VIEW → cards
					pageItems.forEach(p => {
						const card = document.createElement('div');
						card.className = 'product-card';

						const stockClass =
							p.stock <= 0 ? 'stock-sold-out' :
								p.stock <= 10 ? 'stock-low' :
									p.stock <= 30 ? 'stock-medium' : 'stock-high';

						card.innerHTML = `
          <img src="${p.img}" class="product-img" alt="${p.name}">
          <div class="product-body">
            <div class="product-category">${p.category}</div>
            <a href="#" class="product-name">${p.name}</a>
            <div class="product-rating">
              ${'★'.repeat(Math.floor(p.rating))}${'☆'.repeat(5 - Math.floor(p.rating))}
              <span class="text-muted">(${p.reviews})</span>
            </div>
            <div class="price-stock">
              <div class="price">$${p.price.toFixed(2)}</div>
              <div class="stock-badge ${stockClass}">
                ${p.stock <= 0 ? 'Sold Out' : p.stock + ' in stock'}
              </div>
            </div>
            <div class="product-actions">
              <button class="btn-action btn-edit" data-action="edit" data-sku="${p.sku}">
                <i class="bi bi-pencil-square"></i> Edit
              </button>
              <button class="btn-action btn-delete" data-action="delete" data-sku="${p.sku}">
                <i class="bi bi-trash"></i> Delete
              </button>
            </div>
          </div>
        `;
						productsEl.appendChild(card);
					});

				} else {
					// LIST VIEW → table
					const tableWrapper = document.createElement('div');
					tableWrapper.className = 'table-responsive'; // Add this wrapper for horizontal scrolling

					const table = document.createElement('table');
					table.className = 'table table-bordered align-middle text-center bg-white shadow-sm';
					table.innerHTML = `
    <thead class="table-dark">
    <tr>
        <th>Image</th>
        <th>Name</th>
        <th>Category</th>
        <th>Price ($)</th>
        <th>Stock</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    ${pageItems.map(p => `
        <tr>
        <td><img src="${p.img}" alt="${p.name}" style="width:70px; height:70px; object-fit:cover; border-radius:8px;"></td>
        <td class="fw-semibold">${p.name}</td>
        <td>${p.category}</td>
        <td>$${p.price.toFixed(2)}</td>
        <td>
            <span class="stock-badge 
            ${p.stock <= 0 ? 'stock-sold-out' :
							p.stock <= 10 ? 'stock-low' :
								p.stock <= 30 ? 'stock-medium' : 'stock-high'}">
            ${p.stock <= 0 ? 'Sold Out' : p.stock + ' in stock'}
            </span>
        </td>
        <td>
            <button class="btn btn-sm btn-secondary me-1" data-action="edit" data-sku="${p.sku}">
            <i class="bi bi-pencil-square"></i> Edit
            </button>
            <button class="btn btn-sm btn-danger" data-action="delete" data-sku="${p.sku}">
            <i class="bi bi-trash"></i> Delete
            </button>
        </td>
        </tr>
    `).join('')}
    </tbody>
`;

					// Append the table to the wrapper
					tableWrapper.appendChild(table);

					// Append the wrapper to the products element
					productsEl.appendChild(tableWrapper);
				}
			}

			pageIndicator.textContent = `${currentPage} / ${totalPages}`;
			document.getElementById('prev').disabled = currentPage === 1;
			document.getElementById('next').disabled = currentPage === totalPages;
		}

		// event delegration of edit and delete
		// Bootstrap modal instances
		const editModal = new bootstrap.Modal(document.getElementById('editModal'));
		const deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));

		// Handle Edit & Delete buttons
		document.addEventListener('click', (e) => {
			const btn = e.target.closest('button[data-action]');
			if (!btn) return;
			const action = btn.dataset.action;
			const sku = btn.dataset.sku;

			if (action === 'edit') {
				const product = products.find(p => p.sku === sku);
				if (product) {
					document.getElementById('editSku').value = product.sku;
					document.getElementById('editName').value = product.name;
					document.getElementById('editCategory').value = product.category;
					document.getElementById('editPrice').value = product.price;
					document.getElementById('editStock').value = product.stock;
					editModal.show();
				}
			} else if (action === 'delete') {
				document.getElementById('deleteSku').value = sku;
				document.getElementById('deleteMessage').textContent =
					`Are you sure you want to delete product "${sku}"?`;
				deleteModal.show();
			}
		});

		// Save changes from edit modal
		document.getElementById('editForm').addEventListener('submit', (e) => {
			e.preventDefault();
			const sku = document.getElementById('editSku').value;
			const product = products.find(p => p.sku === sku);
			if (product) {
				product.name = document.getElementById('editName').value;
				product.category = document.getElementById('editCategory').value;
				product.price = parseFloat(document.getElementById('editPrice').value);
				product.stock = parseInt(document.getElementById('editStock').value);
				renderProducts();
				editModal.hide();
			}
		});

		// Confirm delete
		document.getElementById('confirmDelete').addEventListener('click', () => {
			const sku = document.getElementById('deleteSku').value;
			const index = products.findIndex(p => p.sku === sku);
			if (index !== -1) {
				products.splice(index, 1);
				renderProducts();
			}
			deleteModal.hide();
		});


		// Grid/List toggle
		let currentView = 'grid'; // default
		document.getElementById('gridView').addEventListener('click', () => {
			currentView = 'grid';
			productsEl.className = 'products-grid';
			document.getElementById('gridView').classList.add('active');
			document.getElementById('listView').classList.remove('active');
			renderProducts();
		});

		document.getElementById('listView').addEventListener('click', () => {
			currentView = 'list';
			productsEl.className = 'products-list';
			document.getElementById('listView').classList.add('active');
			document.getElementById('gridView').classList.remove('active');
			renderProducts();
		});

		// filters
		document.getElementById('filter').addEventListener('change', e => { currentFilter = e.target.value; currentPage = 1; renderProducts(); });
		document.getElementById('search').addEventListener('input', e => { currentQuery = e.target.value; currentPage = 1; renderProducts(); });
		document.getElementById('sort').addEventListener('change', e => { currentSort = e.target.value; currentPage = 1; renderProducts(); });
		document.getElementById('minPrice').addEventListener('input', e => { currentMinPrice = e.target.value ? parseFloat(e.target.value) : ''; renderProducts(); });
		document.getElementById('maxPrice').addEventListener('input', e => { currentMaxPrice = e.target.value ? parseFloat(e.target.value) : ''; renderProducts(); });

		document.getElementById('reset').addEventListener('click', () => {
			currentFilter = 'all';
			currentQuery = '';
			currentSort = 'default';
			currentMinPrice = '';
			currentMaxPrice = '';
			document.getElementById('filter').value = 'all';
			document.getElementById('search').value = '';
			document.getElementById('sort').value = 'default';
			document.getElementById('minPrice').value = '';
			document.getElementById('maxPrice').value = '';
			renderProducts();
		});

		// pagination
		document.getElementById('prev').addEventListener('click', () => { if (currentPage > 1) { currentPage--; renderProducts(); } });
		document.getElementById('next').addEventListener('click', () => { currentPage++; renderProducts(); });

		// empty state refresh
		document.getElementById('empty-refresh').addEventListener('click', () => {
			currentFilter = 'all';
			currentQuery = '';
			currentSort = 'default';
			currentMinPrice = '';
			currentMaxPrice = '';
			document.getElementById('filter').value = 'all';
			document.getElementById('search').value = '';
			document.getElementById('sort').value = 'default';
			document.getElementById('minPrice').value = '';
			document.getElementById('maxPrice').value = '';
			renderProducts();
		});

		renderProducts();
	</script>
</body>

</html>