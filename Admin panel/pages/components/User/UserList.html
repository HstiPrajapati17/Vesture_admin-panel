<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>User List â€” Clothing Manufacturing</title>

	<!-- Bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="/css/Sidebar.css">
	<link rel="stylesheet" href="/css/user.css">
	<link rel="stylesheet" href="/css/product.css">

	<style>
		.user-img {
			width: 40px;
			height: 40px;
			border-radius: 50%;
			margin-right: 8px;
		}
		.user-info {
			display: flex;
			align-items: center;
		}
	</style>
</head>

<body>
	<!-- Sidebar -->
	<div id="sidebar-container"></div>
	<!-- Navbar -->
	<div id="navbar-container"></div>

	<main class="main-content" id="main-content">
		<div class="container-fluid p-4">

			<!-- Header -->
			<div class="d-flex justify-content-between align-items-center">
				<h4>User List</h4>
				<a href="/pages/components/User/AddUser.html">
					<button class="btn btn-primary">
						<i class="bi bi-plus-circle"></i> Add User
					</button>
				</a>
			</div>

			<!-- Users Table -->
			<div class="h_user-list mt-4">
				<div class="table-responsive">
					<table class="table h_custom-table align-middle text-center">
						<thead class="table-dark">
							<tr>
								<th>User</th>
								<th>Email</th>
								<th>Phone</th>
								<th>City</th>
								<th>Role</th>
								<th>Actions</th>
							</tr>
						</thead>
						<tbody id="userTableBody"></tbody>
					</table>
				</div>

				<!-- Pagination -->
				<nav class="d-flex justify-content-center align-items-center mt-3 gap-3" id="paginationNav">
					<button class="btn btn-sm cp-page-btn" id="prevBtn">Prev</button>
					<span id="pageInfo" class="fw-bold" style="color:#604652;">1/1</span>
					<button class="btn btn-sm cp-page-btn" id="nextBtn">Next</button>
				</nav>
			</div>

		</div>
	</main>

	<!-- Overlay -->
	<div class="overlay"></div>

	<!-- View Modal -->
	<div class="modal fade" id="viewModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">View User</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body" id="viewModalBody"></div>
			</div>
		</div>
	</div>

	<!-- Edit Modal -->
	<div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Edit User</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="editForm">
						<div class="mb-3">
							<label class="form-label">Name</label>
							<input type="text" class="form-control" id="editName">
						</div>
						<div class="mb-3">
							<label class="form-label">Email</label>
							<input type="email" class="form-control" id="editEmail">
						</div>
						<div class="mb-3">
							<label class="form-label">Phone</label>
							<input type="text" class="form-control" id="editPhone">
						</div>
						<div class="mb-3">
							<label class="form-label">City</label>
							<input type="text" class="form-control" id="editCity">
						</div>
						<div class="mb-3">
							<label class="form-label">Role</label>
							<input type="text" class="form-control" id="editRole">
						</div>
						<button type="submit" class="btn btn-success">Save Changes</button>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- Delete Modal -->
	<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Confirm Delete</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<p>Are you sure you want to delete this user?</p>
					<div class="d-flex justify-content-end">
						<button class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
						<button class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Bootstrap Bundle -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="/js/sidebar-loader.js"></script>
	<script src="/js/navbar-loader.js"></script>

	<script>
		const users = [
			{ name: "Alice Johnson", image: "https://i.pravatar.cc/40?img=1", email: "alice@example.com", phone: "123-456-7890", city: "Toronto", role: "User" },
			{ name: "Bob Smith", image: "https://i.pravatar.cc/40?img=2", email: "bob@example.com", phone: "234-567-8901", city: "Vancouver", role: "Admin" },
			{ name: "Charlie Lee", image: "https://i.pravatar.cc/40?img=3", email: "charlie@example.com", phone: "345-678-9012", city: "Montreal", role: "Manager" },
			{ name: "David Brown", image: "https://i.pravatar.cc/40?img=4", email: "david@example.com", phone: "456-789-0123", city: "Calgary", role: "User" },
			{ name: "Emma Wilson", image: "https://i.pravatar.cc/40?img=5", email: "emma@example.com", phone: "567-890-1234", city: "Ottawa", role: "User" },
			{ name: "Frank Thomas", image: "https://i.pravatar.cc/40?img=6", email: "frank@example.com", phone: "678-901-2345", city: "Edmonton", role: "Admin" }
		];

		const rowsPerPage = 5;
		let currentPage = 1;
		let userToDelete = null;

	function renderTable() {
	const tableBody = document.getElementById("userTableBody");
	tableBody.innerHTML = "";

	const start = (currentPage - 1) * rowsPerPage;
	const end = start + rowsPerPage;
	const paginatedUsers = users.slice(start, end);

	paginatedUsers.forEach(u => {
		const tr = document.createElement("tr");
		tr.innerHTML = `
			<td class="user-info"><img src="${u.image}" class="user-img"> ${u.name}</td>
			<td>${u.email}</td>
			<td>${u.phone}</td>
			<td>${u.city}</td>
			<td>${u.role}</td>
			<td>
				<button class="btn btn-sm h_user-list-btn" onclick="openView('${u.name}','${u.email}','${u.phone}','${u.city}','${u.role}')"><i class="bi bi-eye"></i></button>
				<button class="btn btn-sm h_user-list-btn" onclick="openEdit('${u.name}','${u.email}','${u.phone}','${u.city}','${u.role}')"><i class="bi bi-pencil-square"></i></button>
				<button class="btn btn-sm h_user-list-btn" onclick="openDelete('${u.name}')"><i class="bi bi-trash3"></i></button>
			</td>
		`;
		tableBody.appendChild(tr);
	});

	// pagination info
	const totalPages = Math.ceil(users.length / rowsPerPage);
	document.getElementById("pageInfo").innerText = `${currentPage}/${totalPages}`;

	// show/hide pagination
	const pagination = document.getElementById("paginationNav");
	if (totalPages <= 1) {
		pagination.classList.add("d-none");
	} else {
		pagination.classList.remove("d-none");
	}

	// disable prev/next button at limits
	document.getElementById("prevBtn").disabled = currentPage === 1;
	document.getElementById("nextBtn").disabled = currentPage === totalPages;
}


		// View
		function openView(name, email, phone, city, role) {
			document.getElementById("viewModalBody").innerHTML = `
				<p><strong>Name:</strong> ${name}</p>
				<p><strong>Email:</strong> ${email}</p>
				<p><strong>Phone:</strong> ${phone}</p>
				<p><strong>City:</strong> ${city}</p>
				<p><strong>Role:</strong> ${role}</p>
			`;
			new bootstrap.Modal(document.getElementById("viewModal")).show();
		}

		// Edit
		function openEdit(name, email, phone, city, role) {
			document.getElementById("editName").value = name;
			document.getElementById("editEmail").value = email;
			document.getElementById("editPhone").value = phone;
			document.getElementById("editCity").value = city;
			document.getElementById("editRole").value = role;
			new bootstrap.Modal(document.getElementById("editModal")).show();
		}

		// Delete
		function openDelete(name) {
			userToDelete = name;
			document.querySelector("#deleteModal .modal-body p").innerHTML =
				`Are you sure you want to delete <strong>${name}</strong>?`;
			new bootstrap.Modal(document.getElementById("deleteModal")).show();
		}

		document.getElementById("confirmDeleteBtn").addEventListener("click", () => {
			if (userToDelete) {
				const index = users.findIndex(u => u.name === userToDelete);
				if (index !== -1) {
					users.splice(index, 1);
					renderTable();
				}
				userToDelete = null;
				const modalEl = document.getElementById("deleteModal");
				const modal = bootstrap.Modal.getInstance(modalEl);
				modal.hide();
			}
		});

		// Pagination
		document.getElementById("prevBtn").addEventListener("click", () => {
			if (currentPage > 1) {
				currentPage--;
				renderTable();
			}
		});
		document.getElementById("nextBtn").addEventListener("click", () => {
			if (currentPage < Math.ceil(users.length / rowsPerPage)) {
				currentPage++;
				renderTable();
			}
		});

		// Initial render
		renderTable();
	</script>
</body>
</html>
