<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Pending Orders</title>

	<!-- Bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
	<link rel="stylesheet" href="/css/Sidebar.css">
	<link rel="stylesheet" href="/css/sales.css">
	<style>
		.h_custom-card {
			border: 1px solid #e0e0e0;
			border-radius: 8px;
			background-color: #f9f9f9;
			overflow: hidden;
		}
	
		.h_custom-card-body {
			padding: 1.25rem;
		}
	
		.h_custom-card-header {
			background-color: #f1f1f1;
			padding: 0.75rem 1.25rem;
			font-weight: bold;
			border-bottom: 1px solid #e0e0e0;
		}
	
		.h_detail-label {
			font-size: 0.8rem;
			color: #888;
			margin-bottom: 0.25rem;
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}
	
		.h_detail-value {
			font-weight: 500;
			color: #333;
			margin: 0;
		}
	</style>
</head>

<body>
	<!-- Sidebar -->
	<div id="sidebar-container"></div>

	<!-- Navbar -->
	<div id="navbar-container"></div>

	<main class="main-content custome-height-main-content" id="main-content">
		<div class="container-fluid p-4">

			<!-- Orders Table -->
			<div class="h_order-list mt-4">
				<div class="d-flex justify-content-between align-items-center mb-3">
					<h4>Pending Orders</h4>
					<div class="dropdown">
						<button class="btn h_order-list-filter-btn dropdown-toggle" type="button" id="filterDropdown"
							data-bs-toggle="dropdown" aria-expanded="false">
							This Month
						</button>
						<ul class="dropdown-menu" aria-labelledby="filterDropdown">
							<li><a class="dropdown-item" href="#">This Week</a></li>
							<li><a class="dropdown-item" href="#">This Month</a></li>
							<li><a class="dropdown-item" href="#">This Year</a></li>
							<li><a class="dropdown-item" href="#">All Time</a></li>
						</ul>
					</div>
				</div>

				<div class="table-responsive">
					<table class="table h_custom-sales-table align-middle text-center" id="orderTable">
						<thead class="table-dark">
							<tr>
								<th>#</th>
								<th>Customer</th>
								<th>Order ID</th>
								<th>Status</th>
								<th>Total (CAD)</th>
								<th>Date</th>
								<th>Action</th>
							</tr>
						</thead>
						<tbody id="tableBody">
							<!-- Filled by JS -->
						</tbody>
					</table>
				</div>

				<!-- Pagination -->
				<nav class="d-flex justify-content-center align-items-center mt-3 gap-3">
					<button class="btn btn-sm h_order-list-filter-btn" id="prevBtn">Prev</button>
					<span id="pageInfo" class="fw-bold" style="color: #604652;">1/1</span>
					<button class="btn btn-sm h_order-list-filter-btn" id="nextBtn">Next</button>
				</nav>
			</div>
		</div>
	</main>

	<!-- Order Details Custom Modal -->
	<div class="custom-modal-overlay" id="orderModalCustom">
		<div class="custom-modal large">
			<div class="custom-modal-header">
				<h5 id="orderModalTitle">Order Details</h5>
				<!-- <button class="close-btn" onclick="closeCustomModal('orderModalCustom')">&times;</button> -->
			</div>
			<div class="custom-modal-body" id="modalContent"></div>
			<div class="custom-modal-footer">
				<button class="custome_modal_btn" onclick="closeCustomModal('orderModalCustom')">Close</button>
			</div>
		</div>
	</div>

	<!-- Delete Confirmation Custom Modal -->
	<div class="custom-modal-overlay" id="deleteModalCustom">
		<div class="custom-modal">
			<div class="custom-modal-header">Confirm Delete</div>
			<div class="custom-modal-body">
				<p id="deleteModalText">Are you sure you want to delete this order?</p>
			</div>
			<div class="custom-modal-footer">
				<button class="custome_modal_btn" onclick="closeCustomModal('deleteModalCustom')">Cancel</button>
				<button class="custome_modal_btn h_cstm_modal-btn" id="confirmDeleteBtn">Delete</button>
			</div>
		</div>
	</div>

	<!-- Overlay for mobile -->
	<div class="overlay"></div>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="/js/sidebar-loader.js"></script>
	<script src="/js/navbar-loader.js"></script>

	<script>
		// Pending Orders only
		const orders = [
			{
				no: 1, customer: "Jung S. Ayala", id: "#456754/80", status: "Pending",
				total: "CAD $125.00", date: "2023-09-16",
				products: [{ name: "Winter Jacket", size: "L", color: "Grey", fabric: "Wool", qty: 1 }]
			},
			{
				no: 2, customer: "Cecile D. Gordon", id: "#348930/80", status: "Pending",
				total: "CAD $89.00", date: "2023-09-18",
				products: [
					{ name: "T-shirt", size: "S", color: "Red", fabric: "Cotton", qty: 1 },
					{ name: "Shorts", size: "M", color: "Black", fabric: "Polyester", qty: 1 }
				]
			},
			{
				no: 3, customer: "Mark Thompson", id: "#789654/80", status: "Pending",
				total: "CAD $210.00", date: "2023-09-20",
				products: [
					{ name: "Denim Jacket", size: "M", color: "Blue", fabric: "Denim", qty: 2 },
					{ name: "Sneakers", size: "43", color: "White", fabric: "Leather", qty: 1 }
				]
			},
			{
				no: 4, customer: "Sophia Lee", id: "#563241/80", status: "Pending",
				total: "CAD $320.00", date: "2023-09-21",
				products: [
					{ name: "Evening Dress", size: "M", color: "Black", fabric: "Silk", qty: 1 },
					{ name: "Heels", size: "38", color: "Red", fabric: "Leather", qty: 1 }
				]
			},
			{
				no: 5, customer: "James Wilson", id: "#852963/80", status: "Pending",
				total: "CAD $150.00", date: "2023-09-22",
				products: [{ name: "Sweatshirt", size: "L", color: "Grey", fabric: "Fleece", qty: 2 }]
			},
			{
				no: 6, customer: "Emily Davis", id: "#963258/80", status: "Pending",
				total: "CAD $275.00", date: "2023-09-23",
				products: [
					{ name: "Casual Blouse", size: "M", color: "Pink", fabric: "Cotton", qty: 3 },
					{ name: "Skirt", size: "S", color: "Navy", fabric: "Polyester", qty: 1 }
				]
			}
		];

		const rowsPerPage = 5;
		let currentPage = 1;
		let orderToDelete = null;

		function renderTable() {
			const tableBody = document.getElementById('tableBody');
			tableBody.innerHTML = "";

			const start = (currentPage - 1) * rowsPerPage;
			const end = start + rowsPerPage;
			const paginatedOrders = orders.slice(start, end);

			paginatedOrders.forEach(order => {
				const statusBadge = `<span class="custom-badge">${order.status}</span>`;

				const tr = document.createElement('tr');
				tr.innerHTML = `
					<td>${order.no}</td>
					<td>${order.customer}</td>
					<td>${order.id}</td>
					<td>${statusBadge}</td>
					<td>${order.total}</td>
					<td>${order.date}</td>
					<td>
						<button class="btn btn-sm me-1 orderlist-table-icons" onclick="viewOrder(${order.no})">
							<i class="bi bi-eye"></i>
						</button>
						<button class="btn btn-sm orderlist-table-icons" onclick="deleteOrder(${order.no})">
							<i class="bi bi-trash"></i>
						</button>
					</td>
				`;
				tableBody.appendChild(tr);
			});

			// Pagination info
			const totalPages = Math.ceil(orders.length / rowsPerPage);
			document.getElementById("pageInfo").innerText = `${currentPage}/${totalPages}`;

			// Show/hide pagination
			
				// pagination show/hide
	const pagination = document.querySelector("nav");
	if (totalPages <= 1) {
		pagination.classList.add("d-none");
	} else {
		pagination.classList.remove("d-none");
	}

	// âœ… Prev/Next disable logic
	document.getElementById("prevBtn").disabled = (currentPage === 1);
	document.getElementById("nextBtn").disabled = (currentPage === totalPages);
}
	

		// Modal helpers
		function openCustomModal(id) { document.getElementById(id).style.display = "flex"; }
		function closeCustomModal(id) { document.getElementById(id).style.display = "none"; }

		// View Order with new design
function viewOrder(orderNo) {
    const order = orders.find(o => o.no === orderNo);
    if (order) {
        let productRows = order.products.map(p =>
            `<li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>${p.name}</strong><br>
                    <small class="text-muted">Size: ${p.size}, Color: ${p.color}, Fabric: ${p.fabric}</small>
                </div>
                <span class="badge bg-secondary rounded-pill">${p.qty}</span>
            </li>`
        ).join("");

        document.getElementById("modalContent").innerHTML = `
            <div class="h_custom-card">
                <div class="h_custom-card-body">
                    <div class="row">
                        <div class="col-6 mb-3">
                            <p class="h_detail-label">Customer</p>
                            <p class="h_detail-value">${order.customer}</p>
                        </div>
                        <div class="col-6 mb-3">
                            <p class="h_detail-label">Order ID</p>
                            <p class="h_detail-value">${order.id}</p>
                        </div>
                        <div class="col-6 mb-3">
                            <p class="h_detail-label">Status</p>
                            <p class="h_detail-value"><span class="custom-badge">${order.status}</span></p>
                        </div>
                        <div class="col-6 mb-3">
                            <p class="h_detail-label">Total</p>
                            <p class="h_detail-value">${order.total}</p>
                        </div>
                        <div class="col-12 mb-3">
                            <p class="h_detail-label">Order Date</p>
                            <p class="h_detail-value">${order.date}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="h_custom-card mt-3">
                <div class="h_custom-card-header">Products</div>
                <ul class="list-group list-group-flush">${productRows}</ul>
            </div>`;
        openCustomModal("orderModalCustom");
    }
}

		// Close modal when clicking on overlay
		document.getElementById("orderModalCustom").addEventListener("click", function (e) {
			if (e.target === this) {
				closeCustomModal("orderModalCustom");
			}
		});

		document.getElementById("deleteModalCustom").addEventListener("click", function (e) {
			if (e.target === this) {
				closeCustomModal("deleteModalCustom");
			}
		});

		// Delete Order
		function deleteOrder(orderNo) {
			orderToDelete = orderNo;
			document.getElementById("deleteModalText").innerText =
				`Are you sure you want to delete order #${orderNo}?`;
			openCustomModal("deleteModalCustom");
		}

		// Confirm Delete
		document.getElementById("confirmDeleteBtn").addEventListener("click", () => {
			if (orderToDelete !== null) {
				const index = orders.findIndex(o => o.no === orderToDelete);
				if (index !== -1) {
					orders.splice(index, 1);
					renderTable();
				}
				orderToDelete = null;
				closeCustomModal("deleteModalCustom");
			}
		});

		// Pagination
		document.getElementById("prevBtn").addEventListener("click", () => {
			if (currentPage > 1) {
				currentPage--;
				renderTable();
			}
		});
		document.getElementById("nextBtn").addEventListener("click", () => {
			if (currentPage < Math.ceil(orders.length / rowsPerPage)) {
				currentPage++;
				renderTable();
			}
		});

		// Initial render
		renderTable();
	</script>
</body>

</html>