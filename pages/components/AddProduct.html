<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Add Product â€” Clothing Manufacturing Admin</title>

	<!-- Bootstrap CSS & Icons -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

	<style>
		:root {
			--h-primary: #607274;
			--h-light: #fffaf1;
			--h-ink: #2a3232;
			--h-soft: rgba(96, 114, 116, .18);
			--h-muted: #6c757d;
			--toggle-on: #607274;
			--toggle-off: #bbbaba;
		}

		/* Page base */
		body {
			background: #8e9a98;
			/* background: linear-gradient(180deg, var(--h-primary) 0%, #536266 40%, #46565A 100%); */
			font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
			color: var(--h-ink);
			margin: 0;
			padding: 28px 10px;
			-ms-overflow-style: none;
		}

		body::-webkit-scrollbar {
			display: none;
		}

		.h_container {
			max-width: 1200px;
			margin: 0 auto;
		}

		/* sheet */
		.h_sheet {
			background: #8e9a98;
			box-shadow: 0 12px 32px rgba(0, 0, 0, .18);
			overflow: hidden;
			display: flex;
			flex-direction: column;
			gap: 12px;
		}

		.h_sheet-header {
			background: var(--h-light);
			color: var(--h-primary);
			padding: 14px 18px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			gap: 12px;
		}

		.h_sheet-title {
			display: flex;
			gap: 10px;
			align-items: center;
			font-weight: 600;
			font-size: 20px;
		}

		.h_badge {
			background: var(--h-light);
			color: var(--h-primary);
			padding: 6px 10px;
			border-radius: 999px;
			font-weight: 700;
			font-size: .85rem;
		}

		/* layout */
		.h_form {
			display: grid;
			grid-template-columns: 420px 1fr;
			gap: 0;
			align-items: start;
			background: var(--h-light);
			padding: 12px;
		}

		/* fallback for tiny screens: single column (also for tablet/phone) */
		@media (max-width: 991.98px) {
			.h_form {
				grid-template-columns: 1fr;
			}
		}

		/* left (was previously right) */
		.h_right {
			padding: 16px;
			border-left: 1px dashed var(--h-soft);
			background: #fffaf6;
		}

		/* if placed as first-child (i.e. visually left column), show border-right instead */
		.h_form>.h_right:first-child {
			border-right: 1px dashed var(--h-soft);
			border-left: none;
		}

		@media (max-width: 991.98px) {
			.h_right {
				border-left: none;
				border-top: 1px dashed var(--h-soft);
			}
		}

		/* right (was previously left) */
		.h_left {
			padding: 20px;
			background-color: #fffaf1;
		}

		/* simple label/input style (prefixed) */
		.h_label {
			display: block;
			font-weight: 600;
			color: var(--h-primary);
			margin-bottom: 6px;
			font-size: .95rem;
		}

		.h_main_label {
			font-size: 18px;
			font-weight: 700;
			color: var(--h-primary);
			text-decoration: underline;
			margin-bottom: 8px;
		}

		.h_input,
		.h_select,
		.h_textarea {
			width: 100%;
			padding: 10px 12px;
			border-radius: 10px;
			border: 1.6px solid #acacac;
			background: #fff;
			font-size: .95rem;
			color: var(--h-ink);
			transition: border-color .18s;
			box-sizing: border-box;
		}

		.h_input:hover,
		.h_select:hover,
		.h_textarea:hover {
			border-color: var(--h-primary);
		}

		.h_input:focus,
		.h_select:focus,
		.h_textarea:focus {
			outline: none;
			border-color: var(--h-primary);
			background: #fffaf1;
			box-shadow: none;
		}

		.h_textarea {
			min-height: 120px;
			resize: vertical;
		}

		.h_row {
			display: flex;
			gap: 12px;
		}

		.h_row>* {
			flex: 1;
		}

		.h_field {
			margin-bottom: 14px;
		}

		/* upload areas */
		.h_upload {
			border: 2px dashed var(--h-primary);
			border-radius: 12px;
			padding: 16px;
			text-align: center;
			background: #fffdf6;
			cursor: pointer;
			min-height: 140px;
			gap: 6px;
			box-sizing: border-box;
		}

		.h_upload small {
			color: var(--h-muted);
			display: block;
			margin-top: 6px;
		}

		.h_thumb {
			width: 100%;
			max-width: 140px;
			height: 140px;
			object-fit: cover;
			border-radius: 10px;
			display: block;
			margin: 6px auto 0;
			box-shadow: 0 8px 18px rgba(0, 0, 0, .12);
		}

		/* gallery thumbnails list */
		.h_gallery {
			display: flex;
			gap: 10px;
			flex-wrap: wrap;
			margin-top: 12px;
		}

		.h_gallery .h_pic {
			width: 88px;
			height: 88px;
			border-radius: 8px;
			overflow: hidden;
			position: relative;
			border: 1px solid var(--h-soft);
			background: #fff;
		}

		.h_gallery img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			display: block;
		}

		.h_pic .h_remove {
			position: absolute;
			top: 6px;
			right: 6px;
			background: rgba(0, 0, 0, .5);
			color: #fff;
			border-radius: 50%;
			width: 22px;
			height: 22px;
			display: flex;
			align-items: center;
			justify-content: center;
			cursor: pointer;
			font-size: 12px;
		}

		/* variants area */
		.h_variant-list {
			border: 1px solid var(--h-soft);
			border-radius: 10px;
			padding: 10px;
			background: #fff;
		}

		.h_variant-row {
			display: flex;
			gap: 8px;
			align-items: center;
			margin-bottom: 8px;
		}

		.h_variant-row input {
			flex: 1;
		}

		/* make buttons slightly larger target for touch */
		.h_custome_add-btn,
		.btn {
			padding: 8px 12px;
			min-height: 40px;
		}

		/* custom toggle styles */
		.toggles {
			display: flex;
			gap: 18px;
			align-items: center;
			flex-wrap: wrap;
		}

		.custom-toggle {
			--w: 48px;
			display: inline-flex;
			align-items: center;
			gap: 10px;
		}

		.custom-toggle .label {
			font-size: .9rem;
			color: var(--h-muted);
			min-width: 54px;
		}

		.switch {
			width: var(--w);
			height: 32px;
			/* slightly taller for touch */
			background: var(--toggle-off);
			border-radius: 999px;
			display: inline-block;
			position: relative;
			cursor: pointer;
			transition: background .18s;
			box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.03);
			flex-shrink: 0;
		}

		.switch .knob {
			width: 26px;
			height: 26px;
			border-radius: 50%;
			background: #fff;
			position: absolute;
			top: 50%;
			left: 3px;
			transform: translateY(-50%);
			transition: left .18s, box-shadow .18s;
			box-shadow: 0 2px 6px rgba(0, 0, 0, .12);
		}

		.switch.on {
			background: var(--toggle-on);
		}

		.switch.on .knob {
			left: calc(100% - 29px);
		}

		/* action buttons */
		.h_actions {
			display: flex;
			gap: 10px;
			justify-content: flex-end;
			padding: 12px 18px;
			border-top: 1px dashed var(--h-soft);
			background: transparent;
			box-sizing: border-box;
		}

		.h_actions .btn-primary {
			background: var(--h-primary);
			border-color: var(--h-primary);
			font-weight: 600;
		}

		.h_actions .btn-primary:hover {
			background: #fffaf1;
			color: var(--h-primary);
			border-color: var(--h-primary);
		}

		/* small helper */
		.h_help {
			font-size: .85rem;
			color: var(--h-muted);
		}

		/* validation feedback - rely on bootstrap classes */
		.is-invalid {
			border-color: #dc3545 !important;
		}

		.is-valid {
			border-color: #198754 !important;
		}

		/* small dragover */
		.h_dragover {
			outline: 4px solid rgba(96, 114, 116, 0.06);
			transform: translateY(-2px);
			transition: transform .12s;
		}

		.h_custome_add-btn {
			border: 1px solid #607274;
			color: #6c757d;
			padding: 8px;
			font-weight: 600;
			background: transparent;
		}

		.h_custome_add-btn:hover {
			background-color: #607274;
			color: #fffaf1;
		}

		/* ---------- Responsive tweaks for smaller screens ---------- */

		/* tablets / small desktops */
		@media (max-width: 800px) {
			.h_sheet-header {
				padding: 12px 14px;
			}

			.h_left,
			.h_right {
				padding: 14px;
			}

			.h_upload {
				min-height: 120px;
			}

			.h_thumb {
				max-width: 120px;
				height: 120px;
			}
		}

		/* phones */
		@media (max-width: 480px) {
			body {
				padding: 18px 8px;
			}

			.h_sheet-header {
				padding: 10px 12px;
			}

			.h_sheet-title {
				font-size: 16px;
			}

			.h_main_label {
				font-size: 16px;
			}

			.h_input,
			.h_select,
			.h_textarea {
				padding: 9px 10px;
				font-size: .92rem;
			}

			.h_upload {
				min-height: 110px;
				padding: 12px;
			}

			.h_thumb {
				max-width: 100px;
				height: 100px;
			}

			.h_variant-row {
				flex-direction: column;
				align-items: stretch;
			}

			.h_variant-row .btn {
				align-self: flex-end;
				margin-top: 6px;
			}

			.toggles {
				gap: 10px;
			}

			.custom-toggle .label {
				min-width: 44px;
			}

			.switch {
				height: 30px;
			}

			.switch .knob {
				width: 24px;
				height: 24px;
				left: 3px;
			}

			.switch.on .knob {
				left: calc(100% - 27px);
			}
		}

		/* very small phones incl. 320px width */
		@media (max-width: 360px) {
			.h_sheet {
				font-size: 14px;
			}

			.h_left,
			.h_right {
				padding: 12px;
			}

			.h_upload {
				min-height: 100px;
				padding: 10px;
			}

			.h_thumb {
				max-width: 88px;
				height: 88px;
			}

			.h_actions {
				flex-direction: column;
				align-items: stretch;
				gap: 8px;
			}

			.h_actions .btn,
			.h_actions .h_custome_add-btn {
				width: 100%;
				display: block;
			}

			.h_sheet-header {
				gap: 8px;
			}

			.h_sheet-title {
				font-size: 15px;
			}

			.h_main_label {
				font-size: 15px;
			}

			.h_input,
			.h_select,
			.h_textarea {
				padding: 8px 10px;
			}

			.h_variant-row .btn {
				width: 100%;
			}
		}

		/* absolute smallest / 320px */
		@media (max-width: 320px) {
			body {
				padding: 12px 6px;
			}

			.h_sheet-header {
				padding: 8px 10px;
			}

			.h_left,
			.h_right {
				padding: 10px;
			}

			.h_upload {
				min-height: 90px;
				padding: 8px;
			}

			.h_thumb {
				max-width: 72px;
				height: 72px;
			}

			.h_sheet-title {
				font-size: 18px;
			}

			.h_main_label {
				font-size: 18px;
			}

			.h_input,
			.h_select,
			.h_textarea {
				padding: 7px 8px;
				font-size: .88rem;
			}

			.custom-toggle .label {
				display: none;
			}

			.toggles {
				gap: 8px;
			}

			.h_form {
				padding: 0px;
			}
		}
	</style>
</head>

<body>
	<div class="h_container">
		<div class="h_sheet">
			<div class="h_sheet-header">
				<div class="h_sheet-title"><i class="bi bi-box-seam-fill"></i> Add Product</div>
			</div>

			<div class="h_form">
				<!-- RIGHT (now placed first) : images & quick settings (this will appear on left visually) -->
				<div class="h_right">
					<div class="d-flex flex-column gap-2">
						<label class="h_label">Product Image</label>
						<label class="h_upload w-100" for="h_mainImage" id="h_mainUpload"
							aria-label="Upload main product image">
							<i class="bi bi-cloud-arrow-up-fill fs-3 d-block" style="color:var(--h-primary)"></i>
							<strong>Drag & drop</strong> or <u>click to browse</u>
							<div class="h_mini-note mt-1">Max 5MB â€¢ PNG, JPG, JPEG</div>
							<input id="h_mainImage" type="file" accept="image/*" style="display:none"
								aria-hidden="true">
							<img id="h_mainPreview" alt="Main preview" class="h_thumb" style="display:none">
						</label>
					</div>

					<hr style="margin:18px 0; border-color:var(--h-soft)">

					<div>
						<label class="h_label">Quick Settings</label>
						<div class="toggles">
							<div class="custom-toggle" role="group" aria-label="Active toggle">
								<div class="label">Active</div>
								<div class="switch" id="switch_active" tabindex="0" role="switch" aria-checked="true"
									aria-label="Active">
									<div class="knob" aria-hidden="true"></div>
								</div>
								<input type="hidden" id="h_active" value="1">
							</div>

							<div class="custom-toggle" role="group" aria-label="Featured toggle">
								<div class="label">Featured</div>
								<div class="switch" id="switch_featured" tabindex="0" role="switch" aria-checked="false"
									aria-label="Featured">
									<div class="knob" aria-hidden="true"></div>
								</div>
								<input type="hidden" id="h_featured" value="0">
							</div>
						</div>
					</div>

					<hr style="margin:18px 0; border-color:var(--h-soft)">

					<div>
						<label class="h_label">Inventory / Shipping Notes</label>
						<textarea id="h_notes" class="h_textarea"
							placeholder="Any special inventory notes (e.g. lead time)"></textarea>
					</div>
				</div>

				<!-- LEFT (now placed second) : main form -->
				<div class="h_left">
					<form id="h_addProductForm" class="needs-validation" novalidate>
						<div class="row g-3">
							<h5 class="h_main_label">Product Basic Information</h5>
							<!-- Basic -->
							<div class="col-12">
								<label class="h_label">Product Name *</label>
								<input id="h_name" class="h_input" type="text" placeholder="e.g. Men's Classic Polo"
									required>
								<div class="invalid-feedback">Product name is required.</div>
							</div>

							<div class="col-md-4">
								<label class="h_label">SKU *</label>
								<input id="h_sku" class="h_input" type="text" placeholder="SKU code" required>
								<div class="invalid-feedback">SKU required.</div>
							</div>
							<div class="col-md-4">
								<label class="h_label">Brand</label>
								<input id="h_brand" class="h_input" type="text" placeholder="Brand name">
							</div>
							<div class="col-md-4">
								<label class="h_label">Barcode</label>
								<input id="h_barcode" class="h_input" type="text" placeholder="Barcode / UPC">
							</div>

							<div class="col-md-6">
								<label class="h_label">Category *</label>
								<select id="h_category" class="h_select" required>
									<option value="" disabled selected>Select category</option>
									<option value="tshirts">T-Shirts</option>
									<option value="jeans">Jeans</option>
									<option value="jackets">Jackets</option>
									<option value="kurti">Kurti</option>
									<option value="saree">Saree</option>
								</select>
								<div class="invalid-feedback">Category required.</div>
							</div>

							<div class="col-md-6">
								<label class="h_label">Subcategory</label>
								<select id="h_subcategory" class="h_select">
									<option value="" disabled selected>Select subcategory</option>
									<option>Men</option>
									<option>Women</option>
									<option>Kids</option>
								</select>
							</div>

							<!-- price / stock -->
							<div class="col-md-4">
								<label class="h_label">Price (CA$) *</label>
								<input id="h_price" type="number" step="0.01" class="h_input" min="0"
									placeholder="Price" required>
								<div class="invalid-feedback">Price required.</div>
							</div>
							<div class="col-md-4">
								<label class="h_label">Cost</label>
								<input id="h_cost" type="number" step="0.01" class="h_input" min="0" placeholder="Cost">
							</div>
							<div class="col-md-4">
								<label class="h_label">Stock Qty *</label>
								<input id="h_stock" type="number" class="h_input" min="0" placeholder="Stock" required>
								<div class="invalid-feedback">Stock quantity required.</div>
							</div>

							<div class="col-md-4">
								<label class="h_label">Tax %</label>
								<input id="h_tax" type="number" step="0.1" class="h_input" min="0" placeholder="e.g. 5">
							</div>

							<div class="col-12">
								<label class="h_label">Short Description</label>
								<textarea id="h_short" class="h_textarea" placeholder="Short summary"></textarea>
							</div>

							<div class="col-12">
								<label class="h_label">Full Description</label>
								<textarea id="h_description" class="h_textarea"
									placeholder="Enter full product description (materials, care, fit)"></textarea>
							</div>

							<div class="col-md-6">
								<label class="h_label">Tags (comma separated)</label>
								<input id="h_tags" class="h_input" placeholder="e.g. summer, cotton, bestseller">
								<div class="h_help">Separate tags with commas.</div>
							</div>

							<!-- Variants -->
							<div class="col-12">
								<label class="h_label">Variants (Sizes / Colors)</label>
								<div class="h_variant-list" id="h_variantList">
									<!-- dynamic rows go here -->
								</div>

								<div class="d-flex gap-2 mt-2" style="flex-wrap:wrap;">
									<input id="h_variantSize" class="h_input" placeholder="Size (e.g. M, L, 32)"
										style="max-width:220px;">
									<input id="h_variantColor" class="h_input" placeholder="Color (e.g. Navy)"
										style="max-width:220px;">
									<button type="button" class="btn h_custome_add-btn" id="h_addVariantBtn"><i
											class="bi bi-plus"></i>
										Add</button>
								</div>
								<div class="h_help mt-1">Add size/color combinations. You can add stock/price per
									variant later.</div>
							</div>
						</div>
					</form>

					<div class="h_actions">
						<button type="button" class="btn h_custome_add-btn " id="h_resetBtn"><i
								class="bi bi-arrow-counterclockwise"></i> Reset</button>
						<button type="button" class="btn btn-primary" id="h_saveBtn"><i class="bi bi-check2-circle"></i>
							Save Product</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

	<script>
		// ---------- helpers ----------
		const MAX_FILE_MB = 5;
		function fileTooLarge(file) { return file.size > MAX_FILE_MB * 1024 * 1024; }
		function createNode(html) {
			const tmp = document.createElement('div'); tmp.innerHTML = html.trim(); return tmp.firstChild;
		}

		// ---------- form refs ----------
		const form = document.getElementById('h_addProductForm');
		const nameInput = document.getElementById('h_name');
		const skuInput = document.getElementById('h_sku');
		const priceInput = document.getElementById('h_price');
		const stockInput = document.getElementById('h_stock');

		// variants
		const variantList = document.getElementById('h_variantList');
		const vSize = document.getElementById('h_variantSize');
		const vColor = document.getElementById('h_variantColor');
		const addVariantBtn = document.getElementById('h_addVariantBtn');

		// main image
		const mainInput = document.getElementById('h_mainImage');
		const mainPreview = document.getElementById('h_mainPreview');
		const mainUploadLabel = document.getElementById('h_mainUpload');

		// buttons
		const saveBtn = document.getElementById('h_saveBtn');
		const resetBtn = document.getElementById('h_resetBtn');

		// toggles (custom)
		const switchActive = document.getElementById('switch_active');
		// create hidden inputs if missing to avoid JS errors
		let hiddenActive = document.getElementById('h_active');
		if (!hiddenActive) {
			hiddenActive = document.createElement('input');
			hiddenActive.type = 'hidden';
			hiddenActive.id = 'h_active';
			hiddenActive.value = '1';
			document.body.appendChild(hiddenActive);
		}
		const switchFeatured = document.getElementById('switch_featured');
		let hiddenFeatured = document.getElementById('h_featured');
		if (!hiddenFeatured) {
			hiddenFeatured = document.createElement('input');
			hiddenFeatured.type = 'hidden';
			hiddenFeatured.id = 'h_featured';
			hiddenFeatured.value = '0';
			document.body.appendChild(hiddenFeatured);
		}

		// ---------- variant logic ----------
		function renderVariantRow(size, color) {
			const id = 'v_' + Math.random().toString(36).slice(2, 9);
			const row = createNode(`
        <div class="h_variant-row" data-id="${id}">
          <input class="h_input form-control form-control-sm" value="${size}" readonly>
          <input class="h_input form-control form-control-sm" value="${color}" readonly>
          <button type="button" class="btn btn-sm btn-outline-danger h_remove_variant"><i class="bi bi-trash"></i></button>
        </div>
      `);
			row.querySelector('.h_remove_variant').addEventListener('click', () => row.remove());
			variantList.appendChild(row);
			// ensure the newest row is visible on small screens
			row.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
		}

		addVariantBtn.addEventListener('click', () => {
			const size = vSize.value.trim();
			const color = vColor.value.trim();
			if (!size && !color) return;
			renderVariantRow(size || '-', color || '-');
			vSize.value = ''; vColor.value = '';
		});

		// allow Enter key on variant inputs to add
		[vSize, vColor].forEach(inp => {
			inp.addEventListener('keydown', e => {
				if (e.key === 'Enter') {
					e.preventDefault();
					addVariantBtn.click();
				}
			});
		});

		// ---------- main image ----------
		mainUploadLabel.addEventListener('click', () => mainInput.click());
		mainInput.addEventListener('change', (e) => {
			const f = e.target.files?.[0];
			if (!f) return;
			if (fileTooLarge(f)) { alert('Main image exceeds 5MB'); mainInput.value = ''; return; }
			mainPreview.src = URL.createObjectURL(f);
			mainPreview.style.display = 'block';
		});

		// ---------- reset ----------
		resetBtn.addEventListener('click', () => {
			if (!confirm('Reset the form?')) return;
			form.reset();
			mainPreview.style.display = 'none'; mainPreview.src = '';
			variantList.innerHTML = '';
			// reset toggles
			setSwitchState(switchActive, true);
			setSwitchState(switchFeatured, false);
			form.classList.remove('was-validated');
			// reset hidden inputs explicitly
			hiddenActive.value = '1';
			hiddenFeatured.value = '0';
		});

		// ---------- simple save (client-side demo) ----------
		saveBtn.addEventListener('click', () => {
			// trigger form submit
			if (form.reportValidity) {
				form.requestSubmit();
			} else {
				form.submit();
			}
		});

		// Bootstrap validation + custom checks
		form.addEventListener('submit', e => {
			// basic validation
			if (!form.checkValidity()) {
				e.preventDefault(); e.stopPropagation();
			} else {
				// example: collect data and show JSON in console (replace with actual API call)
				e.preventDefault();
				const variants = Array.from(variantList.querySelectorAll('.h_variant-row')).map(r => {
					return {
						size: r.children[0].value,
						color: r.children[1].value
					};
				});
				const payload = {
					name: nameInput.value.trim(),
					sku: skuInput.value.trim(),
					brand: document.getElementById('h_brand').value.trim(),
					price: parseFloat(priceInput.value || 0),
					stock: parseInt(stockInput.value || 0),
					category: document.getElementById('h_category').value,
					subcategory: document.getElementById('h_subcategory').value,
					short: document.getElementById('h_short').value.trim(),
					description: document.getElementById('h_description').value.trim(),
					tags: (document.getElementById('h_tags').value || '').split(',').map(t => t.trim()).filter(Boolean),
					variants,
					active: hiddenActive.value === '1',
					featured: hiddenFeatured.value === '1',
					notes: document.getElementById('h_notes').value.trim()
				};
				console.log('Product payload (demo):', payload);
				alert('Product saved (demo). Check console for payload.');

				// Reset validation styling
				form.classList.remove('was-validated');
			}
			form.classList.add('was-validated');
		});

		// small UX: mark invalid/valid on blur for inputs
		[nameInput, skuInput, priceInput, stockInput].forEach(inp => {
			inp.addEventListener('blur', () => {
				if (inp.checkValidity()) { inp.classList.remove('is-invalid'); inp.classList.add('is-valid'); }
				else { inp.classList.remove('is-valid'); inp.classList.add('is-invalid'); }
			});
		});

		// ---------- custom switch logic ----------
		function setSwitchState(switchEl, on) {
			if (!switchEl) return;
			if (on) {
				switchEl.classList.add('on');
				switchEl.setAttribute('aria-checked', 'true');
			} else {
				switchEl.classList.remove('on');
				switchEl.setAttribute('aria-checked', 'false');
			}
			// update hidden inputs
			if (switchEl === switchActive) hiddenActive.value = on ? '1' : '0';
			if (switchEl === switchFeatured) hiddenFeatured.value = on ? '1' : '0';
		}

		// toggle handler
		function attachSwitch(switchEl) {
			if (!switchEl) return;
			// initialize from aria or default
			const initOn = switchEl.getAttribute('aria-checked') === 'true';
			setSwitchState(switchEl, initOn);

			// click
			switchEl.addEventListener('click', () => {
				const isOn = switchEl.classList.contains('on');
				setSwitchState(switchEl, !isOn);
				// announce to assistive tech
				switchEl.setAttribute('aria-live', 'polite');
			});
			// keyboard (space/enter) - more robust checks for different browsers
			switchEl.addEventListener('keydown', (ev) => {
				if (ev.key === ' ' || ev.key === 'Spacebar' || ev.code === 'Space' || ev.key === 'Enter') {
					ev.preventDefault();
					switchEl.click();
				}
			});
		}

		attachSwitch(switchActive);
		attachSwitch(switchFeatured);

		// initialize default states to match original markup (active checked by default)
		setSwitchState(switchActive, true);
		setSwitchState(switchFeatured, false);
	</script>
</body>

</html>